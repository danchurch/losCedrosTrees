

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>GDAL Option Configuration &mdash; rasterio  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Advanced Datasets" href="datasets.html" />
    <link rel="prev" title="Concurrent processing" href="concurrency.html" /> 

<!-- RTD Extra Head -->

<!-- 
Always link to the latest version, as canonical.
http://docs.readthedocs.org/en/latest/canonical.html
-->
<link rel="canonical" href="configuration.html" />

<link rel="stylesheet" href="https://assets.readthedocs.org/static/css/readthedocs-doc-embed.css" type="text/css" />

<script type="application/json" id="READTHEDOCS_DATA">{"ad_free": false, "api_host": "https://readthedocs.org", "build_date": "2020-07-08T18:00:58Z", "builder": "sphinx", "canonical_url": "https://rasterio.readthedocs.io/en/latest/", "commit": "3ae51c8e", "docroot": "/docs/", "features": {"docsearch_disabled": false}, "global_analytics_code": "UA-17997319-1", "language": "en", "page": "topics/configuration", "programming_language": "py", "project": "rasterio", "proxied_api_host": "/_", "source_suffix": ".rst", "subprojects": {}, "theme": "sphinx_rtd_theme", "user_analytics_code": "", "version": "latest"}</script>

<!--
Using this variable directly instead of using `JSON.parse` is deprecated.
The READTHEDOCS_DATA global variable will be removed in the future.
-->
<script type="text/javascript">
READTHEDOCS_DATA = JSON.parse(document.getElementById('READTHEDOCS_DATA').innerHTML);
</script>

<script type="text/javascript" src="https://assets.readthedocs.org/static/javascript/readthedocs-analytics.js" async="async"></script>
<script type="text/javascript" src="https://assets.readthedocs.org/static/javascript/readthedocs-doc-embed.js" async="async"></script>

<!-- end RTD <extrahead> -->
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> rasterio
          

          
          </a>

          
            
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Python Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli.html">Command Line User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Advanced Topics</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="calc.html">Using rio-calc</a></li>
<li class="toctree-l2"><a class="reference internal" href="color.html">Color</a></li>
<li class="toctree-l2"><a class="reference internal" href="concurrency.html">Concurrent processing</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="configuration.html#">GDAL Option Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#gdal-example">GDAL Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#rasterio">Rasterio</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#when-to-use-rasterio-env">When to use rasterio.Env()</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="datasets.html">Advanced Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="errors.html">Error Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html">Vector Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="fillnodata.html">Filling nodata areas</a></li>
<li class="toctree-l2"><a class="reference internal" href="georeferencing.html">Georeferencing</a></li>
<li class="toctree-l2"><a class="reference internal" href="image_options.html">Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="image_processing.html">Interoperability</a></li>
<li class="toctree-l2"><a class="reference internal" href="masking-by-shapefile.html">Masking a raster using a shapefile</a></li>
<li class="toctree-l2"><a class="reference internal" href="masks.html">Nodata Masks</a></li>
<li class="toctree-l2"><a class="reference internal" href="memory-files.html">In-Memory Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="migrating-to-v1.html">Migrating to Rasterio 1.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="overviews.html">Overviews</a></li>
<li class="toctree-l2"><a class="reference internal" href="plotting.html">Plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="profiles.html">Profiles and Writing Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="reading.html">Reading Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="reproject.html">Reprojection</a></li>
<li class="toctree-l2"><a class="reference internal" href="resampling.html">Resampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="switch.html">Switching from GDAL’s Python bindings</a></li>
<li class="toctree-l2"><a class="reference internal" href="tags.html">Tagging datasets and bands</a></li>
<li class="toctree-l2"><a class="reference internal" href="virtual-warping.html">Virtual Warping</a></li>
<li class="toctree-l2"><a class="reference internal" href="vsi.html">Virtual Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="windowed-rw.html">Windowed reading and writing</a></li>
<li class="toctree-l2"><a class="reference internal" href="writing.html">Writing Datasets</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">Python API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">rasterio</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Advanced Topics</a> &raquo;</li>
        
      <li>GDAL Option Configuration</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/mapbox/rasterio/blob/master/docs/topics/configuration.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="gdal-option-configuration">
<h1>GDAL Option Configuration<a class="headerlink" href="configuration.html#gdal-option-configuration" title="Permalink to this headline">¶</a></h1>
<p>GDAL format drivers and some parts of the library are configurable.</p>
<p>From <a class="reference external" href="https://trac.osgeo.org/gdal/wiki/ConfigOptions">https://trac.osgeo.org/gdal/wiki/ConfigOptions</a>:</p>
<blockquote>
<div><p>ConfigOptions are normally used to alter the default behavior of GDAL
and OGR drivers and in some cases the GDAL and OGR core. They are
essentially global variables the user can set.</p>
</div></blockquote>
<div class="section" id="gdal-example">
<h2>GDAL Example<a class="headerlink" href="configuration.html#gdal-example" title="Permalink to this headline">¶</a></h2>
<p>The following is from <a class="reference external" href="https://github.com/OSGeo/gdal/blob/0b75aa3c39e6d126439fb17eed939de39f6f3720/autotest/gcore/tiff_read.py#L117-L119">GDAL’s test suite</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">gdal</span><span class="o">.</span><span class="n">SetConfigOption</span><span class="p">(</span><span class="s1">&#39;GTIFF_FORCE_RGBA&#39;</span><span class="p">,</span> <span class="s1">&#39;YES&#39;</span><span class="p">)</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="s1">&#39;data/stefan_full_greyalpha.tif&#39;</span><span class="p">)</span>
<span class="n">gdal</span><span class="o">.</span><span class="n">SetConfigOption</span><span class="p">(</span><span class="s1">&#39;GTIFF_FORCE_RGBA&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>With GDAL’s C or Python API, you call a function once to set a global
configuration option before you need it and once again after you’re through
to unset it.</p>
<p>Downsides of this style of configuration include:</p>
<ul class="simple">
<li><p>Options can be configured far from the code they affect.</p></li>
<li><p>There is no API for finding what options are currently set.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">gdal.Open()</span></code> raises an exception in the code above, the
<code class="docutils literal notranslate"><span class="pre">GTIFF_FORCE_RGBA</span></code> option will not be unset.</p></li>
</ul>
<p>That code example can be generalized to multiple options and made to
recover better from errors.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;GTIFF_FORCE_RGBA&#39;</span><span class="p">:</span> <span class="s1">&#39;YES&#39;</span><span class="p">}</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">gdal</span><span class="o">.</span><span class="n">SetConfigOption</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="s1">&#39;data/stefan_full_greyalpha.tif&#39;</span><span class="p">)</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">gdal</span><span class="o">.</span><span class="n">SetConfigOption</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>This is better, but has a lot of boilerplate. Rasterio uses elements of Python
syntax, keyword arguments and the <a class="reference external" href="https://docs.python.org/3.7/reference/compound_stmts.html#the-with-statement"><code class="docutils literal notranslate"><span class="pre">with</span></code></a> statement, to make this cleaner
and easier to use.</p>
</div>
<div class="section" id="rasterio">
<h2>Rasterio<a class="headerlink" href="configuration.html#rasterio" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">Env</span><span class="p">(</span><span class="n">GTIFF_FORCE_RGBA</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">CPL_DEBUG</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;data/stefan_full_greyalpha.tif&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">dataset</span><span class="p">:</span>
       <span class="c1"># Suite of code accessing dataset ``ds`` follows...</span>
</pre></div>
</div>
<p>The object returned when you call <a class="reference internal" href="../api/rasterio.html#rasterio.Env" title="rasterio.Env"><code class="xref py py-class docutils literal notranslate"><span class="pre">rasterio.Env()</span></code></a> is a context manager.  It
handles the GDAL configuration for a specific block of code and resets the
configuration when the block exits for any reason, success or failure. The
Rasterio <code class="docutils literal notranslate"><span class="pre">with</span> <span class="pre">rasterio.Env()</span></code> pattern organizes GDAL configuration into single
statements and makes its relationship to a block of code clear.</p>
<p>If you want to know what options are configured at any time, you could bind it
to a name like so.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">Env</span><span class="p">(</span><span class="n">GTIFF_FORCE_RGBA</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">CPL_DEBUG</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">env</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">env</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>

<span class="c1"># Prints:</span>
<span class="c1"># (&#39;GTIFF_FORCE_RGBA&#39;, True)</span>
<span class="c1"># (&#39;CPL_DEBUG&#39;, True)</span>
</pre></div>
</div>
</div>
<div class="section" id="when-to-use-rasterio-env">
<h2>When to use rasterio.Env()<a class="headerlink" href="configuration.html#when-to-use-rasterio-env" title="Permalink to this headline">¶</a></h2>
<p>Rasterio code is often without the use of an <code class="docutils literal notranslate"><span class="pre">Env</span></code> context block. For instance,
you could use <code class="docutils literal notranslate"><span class="pre">rasterio.open()</span></code> directly without explicity creating an <code class="docutils literal notranslate"><span class="pre">Env</span></code>.
In that case, the <code class="docutils literal notranslate"><span class="pre">open</span></code> function will initialize a default environment in
which to execute the code. Often this default environment is sufficient for most
use cases and you only need to create an explicit <code class="docutils literal notranslate"><span class="pre">Env</span></code> if you are customizing
the default GDAL or format options.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="datasets.html" class="btn btn-neutral float-right" title="Advanced Datasets" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="concurrency.html" class="btn btn-neutral float-left" title="Concurrent processing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Mapbox
      
        <span class="commit">
          Revision <code>3ae51c8e</code>.
        </span>
      

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          <dd><a href="../index.html">latest</a></dd>
        
          <dd><a href="https://rasterio.readthedocs.io/en/stable/">stable</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
          <dd><a href="https://rasterio.readthedocs.io/_/downloads/en/latest/pdf/">pdf</a></dd>
        
          <dd><a href="https://rasterio.readthedocs.io/_/downloads/en/latest/htmlzip/">html</a></dd>
        
          <dd><a href="https://rasterio.readthedocs.io/_/downloads/en/latest/epub/">epub</a></dd>
        
      </dl>
      <dl>
        <dt>On Read the Docs</dt>
          <dd>
            <a href="https://readthedocs.org/projects/rasterio/?fromdocs=rasterio">Project Home</a>
          </dd>
          <dd>
            <a href="https://readthedocs.org/builds/rasterio/?fromdocs=rasterio">Builds</a>
          </dd>
      </dl>
      <hr/>
      Free document hosting provided by <a href="http://www.readthedocs.org">Read the Docs</a>.

    </div>
  </div>



  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
   

</body>
</html>